<!DOCTYPE html>
<html>
<head>
  <title>Chat-io</title>
  <link rel="stylesheet" type="text/css" href="css/chat.css">
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
</head>
<body>
  <header>
    <h1>Chat-io</h1>
  </header>
  <aside>
    <h2>Users</h2>
    <ul id="users"></ul>
  </aside>
  <section id="messages">
    <h2>Messages</h2>
  </section>
  <section id="input">
    <textarea></textarea>
    <button class="send">Send</button>
  </section>
  <script>

    var socket = io.connect();
    var userList = document.getElementById('users');
    var user = prompt('username?');

    socket.emit('login', user);

    function addNewUser(name){
      var item = document.createElement('li');
      var txt = document.createTextNode(name);
      item.appendChild(txt);
      userList.appendChild(item);
    }

    socket.on('online users', function(data){

      while (userList.firstChild) {
        userList.removeChild(userList.firstChild);
      }

      data.forEach(function(el){
        addNewUser(el);
      });

    });

    socket.on('new user', function(data){
      addNewUser(data);
    });

  </script>
</body>
</html>
